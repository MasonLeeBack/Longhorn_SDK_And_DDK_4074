Test Assertion_A13442

Var p:Property, root:Item
Var devId:String, strFullName:String
Var fullNameFlat:String,fullNameFeed:String
Var fullNameFilm:String, fullNameStorage:String
{
    PrintDescriptionFromXML('13.4.4.2')
    StartWia()

    GetRoot(root)

    #Check For New Item Tree
    If(!IsNewTree(root))
    Then
    {
        Writeln '\tThe device does not support New Item Tree'
        Exit Failed 
    }

    If ( !GetProperty(root, p, WIA_DIP_DEV_ID) )
    Then 
    {
        Writeln '\tThis mandatory property does not exist'
        Exit Failed
    }

    devId = GetDeviceIndex()

    fullNameFlat = StrConcat(devId, '\\Root\\Flatbed')
    fullNameFeed = StrConcat(devId, '\\Root\\Feeder')
    fullNameFilm = StrConcat(devId, '\\Root\\Film')
    fullNameStorage = StrConcat(devId, '\\Root\\Storage')

   While(root) Do
   {
        If ( !GetProperty(root, p, WIA_IPA_FULL_ITEM_NAME) )
        Then 
        {    
            Writeln '\tThis mandatory property does not exist'
            Exit Failed
        }

        If (!CheckPropertyAccessFromXML(p) )
        Then 
        {
            Writeln '\tIncorrect access'
            Exit Failed
        }

        If (!CheckPropertyTypeFromXML(p) )
        Then
        {
            Writeln '\tIncorrect vartype'
            Exit Failed
        }

        strFullName = GetStrValue(p)

        #If the Item is Category root, validate the correctness of Item's full name
        If ( IsCategoryRoot(root, 'Flatbed') Or IsCategoryRoot(root, 'Feeder') Or
            IsCategoryRoot(root, 'Film') Or IsCategoryRoot(root, 'Storage'))
        Then 
        {
           If (StrCompare(strFullName, fullNameFlat) And
               StrCompare(strFullName, fullNameFeed) And
               StrCompare(strFullName, fullNameFilm) And
               StrCompare(strFullName, fullNameStorage))
           Then
           {
               Write '\tInvalid  item root full item name '
               Exit Failed
           }
        }

        If(IsPropertyReadWrite(p))
        Then
        {
            If ( SetPropertyInvalidValue(root, p) )
            Then
            {
                Writeln '\tSetting invalid property value succeeded'
                Exit Failed
            }

            If (!CheckSuppValues(root, p))
            Then
            {
                Writeln '\tChecking supported property values failed'
                Exit Failed
            }
        }
        Else
        {
           If (SetPropertyValidValue(root,p) Or SetPropertyInvalidValue(root,p) )
           Then 
           {
                Writeln '\tSetting a read-only property value succeeded'
                Exit Failed
           }
        }

:label:
   GetNextItem(root)
   }

    StopWia()
}
