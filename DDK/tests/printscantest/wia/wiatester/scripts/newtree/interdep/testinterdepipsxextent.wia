Test Assertion_A13478

Assertion '13.4.7.8 WIA_IPS_XEXTENT' 
[
If the device is a scanner, when the current value of this property is changed,
the current values of the following properties might be affected: 
WIA_IPA_PIXELS_PER_LINE, WIA_IPA_BYTES_PER_LINE, WIA_IPA_ITEM_SIZE.
But the last two properties are not tested due to possible padding.
]

Var root:Item
Var pDataType:Property
Var dt, lVal
Var minXEXTENT, maxXEXTENT
{
    StartWia()
    GetRoot(root)
    GetDeviceType(dt)

    If (dt != StiDeviceTypeScanner)
    Then Exit Passed

    GetNextItem(root)

    While ( root ) Do
    {
        If ( !CheckItemType(root, WiaItemTypeImage))
        Then Goto label

        If (!GetProperty(root, pDataType, WIA_IPS_XEXTENT))
        Then 
        {
            Writeln '\tThis mandatory property does not exist'
            Exit Failed
        }

        minXEXTENT  = GetPropertyMinValue(pDataType)
        maxXEXTENT  = GetPropertyMaxValue(pDataType)

        If ( !SetPropertyLong(root, WIA_IPS_XEXTENT, minXEXTENT))
        Then Exit Failed

        If (!GetProperty(root, pDataType, WIA_IPA_PIXELS_PER_LINE))
        Then 
        {
            Writeln '\tThis mandatory property does not exist'
            Exit Failed
        }

        lVal = GetLongValue(pDataType)

        If (lVal != minXEXTENT)
        Then 
        {
            Writeln '\tIncorrect value of WIA_IPA_PIXELS_PER_LINE property'
            Exit Failed
        }


        If ( !SetPropertyLong(root, WIA_IPS_XEXTENT, maxXEXTENT))
        Then Exit Failed

        If (!GetProperty(root, pDataType, WIA_IPA_PIXELS_PER_LINE))
        Then 
        {
            Writeln '\tThis mandatory property does not exist'
            Exit Failed
        }

        lVal = GetLongValue(pDataType)

        If (lVal != maxXEXTENT)
        Then 
        {
            Writeln '\tIncorrect value of WIA_IPA_PIXELS_PER_LINE property'
            Exit Failed
        }

:label:
        GetNextItem(root)
    }

    StopWia()
}
