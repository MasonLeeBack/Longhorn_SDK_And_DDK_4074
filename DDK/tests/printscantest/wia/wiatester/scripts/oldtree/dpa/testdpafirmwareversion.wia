Test Assertion_13411

Var p:Property, root:Item
Var str:String, length:Int
{
    PrintDescriptionFromXML('13.4.1.1')

    StartWia()
    GetRoot(root)

    If(!GetProperty(root, p, WIA_DPA_FIRMWARE_VERSION) )
    Then 
    {
        Writeln '\tThis mandatory property does not exist'
        Exit Failed
    }

    If(!CheckPropertyAccessFromXML(p) )
    Then
    {
        Writeln '\tIncorrect access'
        Exit Failed
    }

    If (!CheckPropertyTypeFromXML(p) )
    Then
    {
        Writeln '\tIncorrect vartype'
        Exit Failed
    }

    str = GetStrValue(p)
    length = StrLength(str)

    If ( length <= 0 ) 
    Then 
    {
        Write '\tInvalid property value length'
        Writeln length
        Exit Failed
    }

    If( IsPropertyReadWrite(p) )
    Then
    {
        If ( SetPropertyInvalidValue(root, p) )
        Then
        {
            Writeln '\tSetting invalid property value succeeded'
            Exit Failed
        }

        If (!CheckSuppValues(root, p))
        Then
        {
            Writeln '\tChecking supported property values failed'
            Exit Failed
        }

    }
    Else
    {
       If( SetPropertyValidValue(root,p) Or SetPropertyInvalidValue(root,p) )
       Then 
       {
            Writeln '\tSetting a read-only property value succeeded'
            Exit Failed
       }

    }

    StopWia()
}
