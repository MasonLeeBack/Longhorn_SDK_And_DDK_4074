Test Assertion_A13441

Var p:Property, root:Item
Var str:String
{
    PrintDescriptionFromXML('13.4.4.1')
    StartWia()
    GetRoot(root)

    If ( !GetProperty(root, p, WIA_IPA_ITEM_NAME) )
    Then 
    {
        Writeln '\tThis mandatory property does not exist'
        Exit Failed
    }

    If (!CheckPropertyAccessFromXML(p) )
    Then 
    {
        Writeln '\tIncorrect access'
        Exit Failed
    }

    If (!CheckPropertyTypeFromXML(p) )
    Then
    {
        Writeln '\tIncorrect vartype'
        Exit Failed
    }

    str = GetStrValue(p)

    If ( StrCompare(str, 'Root') )
    Then 
    {
        Write '\tInvalid root item name: '
        Writeln str
        Exit Failed
    }

    If(IsPropertyReadWrite(p))
    Then
    {
        If ( SetPropertyInvalidValue(root, p) )
        Then
        {
            Writeln '\tSetting invalid property value succeeded'
            Exit Failed
        }

        If (!CheckSuppValues(root, p))
        Then
        {
            Writeln '\tChecking supported property values failed'
            Exit Failed
        }
    }
    Else
    {
       If (SetPropertyValidValue(root,p) Or SetPropertyInvalidValue(root,p) )
       Then 
       {
            Writeln '\tSetting a read-only property value succeeded'
            Exit Failed
       }
    }

    GetNextItem(root)

    While ( root ) Do
    {
        If (!GetProperty(root, p, WIA_IPA_ITEM_NAME))
        Then 
        {
            Writeln '\tThis mandatory property does not exist'
            Exit Failed
        }

        If (!CheckPropertyAccessFromXML(p) )
        Then 
        {
            Writeln '\tIncorrect access'
            Exit Failed
        }

        If (!CheckPropertyTypeFromXML(p) )
        Then
        {
            Writeln '\tIncorrect vartype'
            Exit Failed
        }

        If(IsPropertyReadWrite(p))
        Then
        {
            If ( SetPropertyInvalidValue(root, p) )
            Then
            {
                Writeln '\tSetting invalid property value succeeded'
                Exit Failed
            }

            If (!CheckSuppValues(root, p))
            Then
            {
                Writeln '\tChecking supported property values failed'
                Exit Failed
            }
        }
        Else
        {
           If (SetPropertyValidValue(root,p) Or SetPropertyInvalidValue(root,p) )
           Then 
           {
                Writeln '\tSetting a read-only property value succeeded'
                Exit Failed
           }
        }

        GetNextItem(root)
    }

    StopWia()
}
